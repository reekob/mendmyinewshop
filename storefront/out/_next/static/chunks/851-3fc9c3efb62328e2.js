"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[851],{9279:function(e,t,s){s.d(t,{b:function(){return u}});var a=s(7437),r=s(1047),i=s(9397),n=s(5675),l=s(8930),c=s(1994);function d(e){let{previewUrl:t,fallbackUrl:s,alt:r,className:i}=e,n=t||s||"/placeholder-product.png";return(0,a.jsxs)("div",{className:(0,c.W)("relative bg-gray-100 rounded overflow-hidden",i),children:[(0,a.jsx)("img",{src:n,alt:r,className:"w-full h-full object-cover"}),t&&(0,a.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,a.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-primary-600 text-white",children:"Custom"})})]})}var o=s(8510),m=s(6904);function u(e){let{item:t,compact:s=!1}=e,{updateQuantity:c,removeItem:u}=(0,m.x)(),x=!!(t.design_data||t.design_preview_url),h=()=>{c(t.id,t.qty+1)},p=()=>{c(t.id,t.qty-1)},g=()=>{u(t.id)},y=()=>{alert("Edit design feature coming soon!")};return s?(0,a.jsxs)("div",{className:"flex gap-3 py-3",children:[(0,a.jsx)(d,{previewUrl:t.design_preview_url,fallbackUrl:t.image_url,alt:t.title,className:"w-16 h-16 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:t.title}),x&&(0,a.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-700 mt-0.5",children:"Custom Design"}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:p,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Decrease quantity",children:(0,a.jsx)(r.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"w-8 text-center text-sm font-medium",children:t.qty}),(0,a.jsx)("button",{onClick:h,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Increase quantity",children:(0,a.jsx)(i.Z,{className:"w-4 h-4"})})]}),(0,a.jsx)(o.n,{cents:t.price_cents*t.qty,className:"text-sm text-gray-900"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 self-start",children:[x&&(0,a.jsx)("button",{onClick:y,className:"p-1 text-gray-400 hover:text-blue-500 transition-colors","aria-label":"Edit design",children:(0,a.jsx)(n.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:g,className:"p-1 text-gray-400 hover:text-red-500 transition-colors","aria-label":"Remove item",children:(0,a.jsx)(l.Z,{className:"w-4 h-4"})})]})]}):(0,a.jsxs)("div",{className:"flex gap-4 py-4",children:[(0,a.jsx)(d,{previewUrl:t.design_preview_url,fallbackUrl:t.image_url,alt:t.title,className:"w-24 h-24 sm:w-32 sm:h-32 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-medium text-gray-900",children:t.title}),x&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-700 mt-1",children:"Custom Design"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["SKU: ",t.sku]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-1",children:[x&&(0,a.jsx)("button",{onClick:y,className:"p-2 text-gray-400 hover:text-blue-500 transition-colors","aria-label":"Edit design",children:(0,a.jsx)(n.Z,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:g,className:"p-2 text-gray-400 hover:text-red-500 transition-colors","aria-label":"Remove item",children:(0,a.jsx)(l.Z,{className:"w-5 h-5"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[(0,a.jsx)("button",{onClick:p,className:"p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Decrease quantity",children:(0,a.jsx)(r.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"w-12 text-center text-sm font-medium",children:t.qty}),(0,a.jsx)("button",{onClick:h,className:"p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Increase quantity",children:(0,a.jsx)(i.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)(o.n,{cents:t.price_cents*t.qty,className:"text-base text-gray-900"}),t.qty>1&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,a.jsx)(o.n,{cents:t.price_cents})," each"]})]})]})]})]})}},359:function(e,t,s){s.d(t,{V:function(){return d}});var a=s(7437),r=s(2265),i=s(1817),n=s(8510),l=s(6904),c=s(1619);function d(e){let{compact:t=!1}=e,[s,d]=(0,r.useState)(""),{items:o,subtotalCents:m}=(0,l.x)(),{checkout:u,isLoading:x,error:h}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,r.useState)(!1),[a,i]=(0,r.useState)(null),{items:n}=(0,l.x)();return{checkout:async t=>{var a,r,l;if(0===n.length){let t=Error("Cart is empty");i(t),null===(a=e.onError)||void 0===a||a.call(e,t);return}s(!0),i(null);try{let s=await (0,c.hi)("/v1/carts",{method:"POST",body:{customer_email:t}}),a=n.map(e=>({sku:e.sku,qty:e.qty,...e.design_preview_url&&{design_preview_url:e.design_preview_url},...e.design_data&&{design_data:e.design_data},...e.design_assets&&{design_assets:e.design_assets}}));await (0,c.hi)("/v1/carts/".concat(s.id,"/items"),{method:"POST",body:{items:a}});let i="".concat(window.location.origin,"/success?session_id={CHECKOUT_SESSION_ID}"),l="".concat(window.location.origin,"/cart"),d=await (0,c.hi)("/v1/carts/".concat(s.id,"/checkout"),{method:"POST",body:{success_url:i,cancel_url:l,collect_shipping:!0,shipping_countries:["US"]}});null===(r=e.onSuccess)||void 0===r||r.call(e),window.location.href=d.checkout_url}catch(s){let t=s instanceof Error?s:Error("Checkout failed");i(t),null===(l=e.onError)||void 0===l||l.call(e,t)}finally{s(!1)}},isLoading:t,error:a}}(),p=m(),g=0===o.length,y=e=>{e.preventDefault(),s&&!g&&u(s)},f=s.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return t?(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("span",{className:"text-base font-medium text-gray-900",children:"Subtotal"}),(0,a.jsx)(n.n,{cents:p,className:"text-base text-gray-900"})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-3",children:[(0,a.jsx)("input",{type:"email",value:s,onChange:e=>d(e.target.value),placeholder:"Email for order confirmation",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),h&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:h.message}),(0,a.jsx)("button",{type:"submit",disabled:g||!f||x,className:"w-full py-2 px-4 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):"Checkout"})]}),(0,a.jsx)("p",{className:"mt-3 text-xs text-gray-500 text-center",children:"Shipping and taxes calculated at checkout"})]}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,a.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,a.jsx)(n.n,{cents:p,className:"text-gray-900"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Shipping"}),(0,a.jsx)("span",{className:"text-gray-500",children:"Calculated at checkout"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Tax"}),(0,a.jsx)("span",{className:"text-gray-500",children:"Calculated at checkout"})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3 flex justify-between",children:[(0,a.jsx)("span",{className:"text-base font-semibold text-gray-900",children:"Estimated Total"}),(0,a.jsx)(n.n,{cents:p,className:"text-base font-semibold text-gray-900"})]})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,a.jsx)("input",{id:"email",type:"email",value:s,onChange:e=>d(e.target.value),placeholder:"you@example.com",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"We'll send your order confirmation here"})]}),h&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-700",children:h.message})}),(0,a.jsx)("button",{type:"submit",disabled:g||!f||x,className:"w-full py-3 px-6 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):"Proceed to Checkout"})]}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Secure checkout powered by Stripe"})})]})}},8510:function(e,t,s){s.d(t,{n:function(){return i}});var a=s(7437),r=s(1994);function i(e){let{cents:t,className:s}=e,i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t/100);return(0,a.jsx)("span",{className:(0,r.W)("font-medium",s),children:i})}},1619:function(e,t,s){s.d(t,{hi:function(){return i},cT:function(){return n}});let a={apiUrl:"https://merchant.riki-dd7.workers.dev",apiKey:"pk_6cac8a6e66ed66449be88e9eda5140a68129720dac26e97d"};class r extends Error{constructor(e,t,s){super(s),this.status=e,this.code=t,this.name="ApiError"}}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:s="GET",body:i,headers:n={}}=t,l="".concat(a.apiUrl).concat(e),c=await fetch(l,{method:s,headers:{"Content-Type":"application/json",...a.apiKey&&{Authorization:"Bearer ".concat(a.apiKey)},...n},body:i?JSON.stringify(i):void 0}),d=await c.json();if(!c.ok){var o,m;throw new r(c.status,(null===(o=d.error)||void 0===o?void 0:o.code)||"unknown",(null===(m=d.error)||void 0===m?void 0:m.message)||"An error occurred")}return d}async function n(e){let t=new FormData;t.append("file",e);let s=await fetch("".concat(a.apiUrl,"/v1/designs/upload"),{method:"POST",headers:{...a.apiKey&&{Authorization:"Bearer ".concat(a.apiKey)}},body:t}),i=await s.json();if(!s.ok){var n,l;throw new r(s.status,(null===(n=i.error)||void 0===n?void 0:n.code)||"upload_failed",(null===(l=i.error)||void 0===l?void 0:l.message)||"Upload failed")}return i}},6904:function(e,t,s){s.d(t,{x:function(){return i}});var a=s(9625),r=s(6885);let i=(0,a.Ue)()((0,r.tJ)((e,t)=>({items:[],isOpen:!1,editingItemId:null,addItem:t=>{let s=!!(t.design_data||t.design_preview_url);e(e=>{if(s){let s={...t,id:crypto.randomUUID()};return{items:[...e.items,s]}}let a=e.items.findIndex(e=>e.sku===t.sku&&!e.design_data&&!e.design_preview_url);if(a>=0){let s=[...e.items];return s[a]={...s[a],qty:s[a].qty+t.qty},{items:s}}let r={...t,id:t.sku};return{items:[...e.items,r]}})},removeItem:t=>{e(e=>({items:e.items.filter(e=>e.id!==t)}))},updateQuantity:(s,a)=>{if(a<=0){t().removeItem(s);return}e(e=>({items:e.items.map(e=>e.id===s?{...e,qty:a}:e)}))},clearCart:()=>{e({items:[]})},openCart:()=>{e({isOpen:!0})},closeCart:()=>{e({isOpen:!1})},toggleCart:()=>{e(e=>({isOpen:!e.isOpen}))},setEditingItem:t=>{e({editingItemId:t})},updateItemDesign:(t,s,a,r)=>{e(e=>({items:e.items.map(e=>e.id===t?{...e,design_data:s,design_preview_url:null!=a?a:e.design_preview_url,design_assets:null!=r?r:e.design_assets}:e),editingItemId:null}))},itemCount:()=>t().items.reduce((e,t)=>e+t.qty,0),subtotalCents:()=>t().items.reduce((e,t)=>e+t.price_cents*t.qty,0)}),{name:"cart-storage",partialize:e=>({items:e.items})}))}}]);