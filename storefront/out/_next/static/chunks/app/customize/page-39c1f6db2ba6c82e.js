(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[570],{242:function(e,t,a){Promise.resolve().then(a.bind(a,2449))},9205:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var r=a(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:h,...g}=e;return(0,r.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:a,strokeWidth:l?24*Number(n)/Number(s):n,className:i("lucide",d),...!u&&!c(g)&&{"aria-hidden":"true"},...g},[...h.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:c,...o}=a;return(0,r.createElement)(d,{ref:n,iconNode:t,className:i("lucide-".concat(s(l(e))),"lucide-".concat(e),c),...o})});return a.displayName=l(e),a}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},2449:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return er}});var r=a(7437),s=a(2265),n=a(9376),l=a(6229),i=a(2660),c=a(9205);let o=(0,c.Z)("undo-2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]),d=(0,c.Z)("redo-2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);var u=a(8960);let h=(0,a(9625).Ue)((e,t)=>({productId:null,variantSku:null,mockupConfig:null,currentViewId:"front",canvasStates:{},history:[],historyIndex:-1,uploadedAssets:[],selectedObjectId:null,initialize:(t,a,r)=>{var s;let n=(null===(s=r.views[0])||void 0===s?void 0:s.id)||"front";e({productId:t,variantSku:a,mockupConfig:r,currentViewId:n,canvasStates:{},history:[],historyIndex:-1,uploadedAssets:[],selectedObjectId:null})},setView:t=>{e({currentViewId:t,selectedObjectId:null})},saveCanvasState:(t,a)=>{e(e=>({canvasStates:{...e.canvasStates,[t]:a}}))},pushHistory:(t,a)=>{e(e=>{let r=e.history.slice(0,e.historyIndex+1);return r.push({viewId:t,state:a}),r.length>50&&r.shift(),{history:r,historyIndex:r.length-1,canvasStates:{...e.canvasStates,[t]:a}}})},undo:()=>{let{history:a,historyIndex:r}=t();if(r>0){let t=a[r-1];return e(e=>({historyIndex:r-1,canvasStates:{...e.canvasStates,[t.viewId]:t.state},currentViewId:t.viewId})),t}return null},redo:()=>{let{history:a,historyIndex:r}=t();if(r<a.length-1){let t=a[r+1];return e(e=>({historyIndex:r+1,canvasStates:{...e.canvasStates,[t.viewId]:t.state},currentViewId:t.viewId})),t}return null},canUndo:()=>t().historyIndex>0,canRedo:()=>t().historyIndex<t().history.length-1,addUploadedAsset:t=>{e(e=>({uploadedAssets:[...e.uploadedAssets,t]}))},setSelectedObjectId:t=>{e({selectedObjectId:t})},reset:()=>{e({productId:null,variantSku:null,mockupConfig:null,currentViewId:"front",canvasStates:{},history:[],historyIndex:-1,uploadedAssets:[],selectedObjectId:null})},getDesignData:()=>{let{canvasStates:e,uploadedAssets:a}=t();return{canvasStates:e,assets:a}}}));function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768,[t,a]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=()=>{a(window.innerWidth<e)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[e]),t}function m(){return"obj_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}function x(e){return e.getObjects().filter(e=>{let t=e.data;return!(null==t?void 0:t.isBackground)&&!(null==t?void 0:t.isPrintAreaGuide)})}function p(e){let t=x(e);return JSON.stringify({version:u.i8,objects:t.map(e=>e.toObject(["data","id"]))})}async function v(e,t){let a=JSON.parse(t);x(e).forEach(t=>e.remove(t)),a.objects&&Array.isArray(a.objects)&&(await u.D5.enlivenObjects(a.objects)).forEach(t=>{t&&e.add(t)}),e.renderAll()}let b=(0,s.forwardRef)(function(e,t){let{onCanvasReady:a}=e,n=(0,s.useRef)(null),l=(0,s.useRef)(null),i=(0,s.useRef)(null),c=(0,s.useRef)(!1),{mockupConfig:o,currentViewId:d,canvasStates:m,pushHistory:x,setSelectedObjectId:b}=h(),f=null==o?void 0:o.views.find(e=>e.id===d);return g(),!function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{minScale:r=.5,maxScale:n=3}=a,l=(0,s.useRef)({isPinching:!1,startDistance:0,startAngle:0,initialScale:1,initialAngle:0});(0,s.useEffect)(()=>{if(!e)return;let a=t.current;if(!a)return;let s=e=>{if(e.length<2)return 0;let t=e[0].clientX-e[1].clientX,a=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+a*a)},i=e=>{if(e.length<2)return 0;let t=e[1].clientX-e[0].clientX;return 180/Math.PI*Math.atan2(e[1].clientY-e[0].clientY,t)},c=t=>{if(2===t.touches.length){t.preventDefault(),l.current.isPinching=!0,l.current.startDistance=s(t.touches),l.current.startAngle=i(t.touches);let a=e.getActiveObject();a?(l.current.initialScale=a.scaleX||1,l.current.initialAngle=a.angle||0):l.current.initialScale=e.getZoom()}},o=t=>{if(!l.current.isPinching||2!==t.touches.length)return;t.preventDefault();let a=s(t.touches),c=i(t.touches),o=e.getActiveObject();if(o){let t=a/l.current.startDistance,s=Math.min(n,Math.max(r,l.current.initialScale*t)),i=c-l.current.startAngle,d=l.current.initialAngle+i;o.set({scaleX:s,scaleY:s,angle:d}),e.renderAll()}else{let s=a/l.current.startDistance,i=l.current.initialScale*s;i=Math.min(n,Math.max(r,i));let c=(t.touches[0].clientX+t.touches[1].clientX)/2,o=(t.touches[0].clientY+t.touches[1].clientY)/2,d=e.getElement().getBoundingClientRect(),h=new u.E9(c-d.left,o-d.top);e.zoomToPoint(h,i)}},d=e=>{e.touches.length<2&&(l.current.isPinching=!1)};return a.addEventListener("touchstart",c,{passive:!1}),a.addEventListener("touchmove",o,{passive:!1}),a.addEventListener("touchend",d),()=>{a.removeEventListener("touchstart",c),a.removeEventListener("touchmove",o),a.removeEventListener("touchend",d)}},[e,t,r,n])}(l.current,i,{minScale:.5,maxScale:3}),(0,s.useImperativeHandle)(t,()=>({getCanvas:()=>l.current})),(0,s.useEffect)(()=>{if(n.current&&o&&f)return(async()=>{var e,t,r,s;c.current=!0,l.current&&l.current.dispose();let i=new u.Xz(n.current,{width:o.canvasWidth,height:o.canvasHeight,selection:!0,preserveObjectStacking:!0,backgroundColor:"#f9fafb",allowTouchScrolling:!0,cornerSize:20,cornerStyle:"circle",cornerColor:"#3b82f6",transparentCorners:!1,borderColor:"#3b82f6",borderScaleFactor:2});l.current=i;try{let e=await u.I.fromURL(f.mockupUrl,{crossOrigin:"anonymous"});if(e){let t=o.canvasWidth/(e.width||1),a=o.canvasHeight/(e.height||1);e.set({scaleX:t,scaleY:a,selectable:!1,evented:!1,data:{isBackground:!0}}),i.backgroundImage=e,i.renderAll()}}catch(e){console.error("Failed to load mockup image:",e)}let h=(e=f.printArea.x,t=f.printArea.y,r=f.printArea.width,s=f.printArea.height,new u.UL({left:e,top:t,width:r,height:s,fill:"transparent",stroke:"#3b82f6",strokeWidth:1,strokeDashArray:[5,5],selectable:!1,evented:!1,data:{isPrintAreaGuide:!0}}));i.add(h);let g=m[d];g&&await v(i,g),i.on("selection:created",e=>{var t;let a=null===(t=e.selected)||void 0===t?void 0:t[0],r=null==a?void 0:a.data;(null==r?void 0:r.id)&&b(r.id)}),i.on("selection:updated",e=>{var t;let a=null===(t=e.selected)||void 0===t?void 0:t[0],r=null==a?void 0:a.data;(null==r?void 0:r.id)&&b(r.id)}),i.on("selection:cleared",()=>{b(null)}),i.on("object:modified",()=>{c.current||x(d,p(i))}),i.on("object:added",e=>{let t=e.target,a=null==t?void 0:t.data;null!=a&&a.isBackground||null!=a&&a.isPrintAreaGuide||c.current||x(d,p(i))}),i.on("object:removed",e=>{let t=e.target,a=null==t?void 0:t.data;null!=a&&a.isBackground||null!=a&&a.isPrintAreaGuide||c.current||x(d,p(i))}),c.current=!1,null==a||a(i)})(),()=>{l.current&&(l.current.dispose(),l.current=null)}},[d,null==o?void 0:o.canvasWidth,null==o?void 0:o.canvasHeight,null==f?void 0:f.mockupUrl]),(0,s.useEffect)(()=>{let e=()=>{let e=i.current,t=l.current;if(!e||!t||!o)return;let a=Math.min(1,e.offsetWidth/o.canvasWidth);t.setZoom(a),t.setDimensions({width:o.canvasWidth*a,height:o.canvasHeight*a})},t=setTimeout(e,100);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}},[o]),(0,r.jsx)("div",{ref:i,className:"w-full flex justify-center touch-none",style:{touchAction:"none"},children:(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-hidden shadow-sm bg-white",children:(0,r.jsx)("canvas",{ref:n})})})});var f=a(1994);function y(){let{mockupConfig:e,currentViewId:t,setView:a}=h();return!e||e.views.length<=1?null:(0,r.jsx)("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg",children:e.views.map(e=>(0,r.jsx)("button",{onClick:()=>a(e.id),className:(0,f.W)("px-4 py-2 text-sm font-medium rounded-md transition-colors",t===e.id?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:e.name},e.id))})}let j=(0,c.Z)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]),w=(0,c.Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),N=(0,c.Z)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),k=(0,c.Z)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),S=(0,c.Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),C=(0,c.Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),A=["#000000","#FFFFFF","#EF4444","#F97316","#EAB308","#22C55E","#14B8A6","#3B82F6","#8B5CF6","#EC4899"];function M(e){let{color:t,onChange:a,label:s}=e;return(0,r.jsxs)("div",{children:[s&&(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex gap-1 flex-wrap",children:A.map(e=>(0,r.jsx)("button",{onClick:()=>a(e),className:"w-6 h-6 rounded-full border-2 transition-transform hover:scale-110 ".concat(t===e?"border-blue-600 ring-2 ring-blue-200":"border-gray-200"),style:{backgroundColor:e},title:e},e))}),(0,r.jsx)("input",{type:"color",value:t,onChange:e=>a(e.target.value),className:"w-8 h-8 rounded cursor-pointer"})]})]})}let I=["Arial","Helvetica","Georgia","Times New Roman","Courier New","Impact","Comic Sans MS"],E=[16,20,24,32,40,48,64,80];function O(e){let{canvas:t}=e,[a,n]=(0,s.useState)("Your Text"),[l,i]=(0,s.useState)("Arial"),[c,o]=(0,s.useState)(32),[d,h]=(0,s.useState)("#000000"),[g,x]=(0,s.useState)(!1),[p,v]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text"}),(0,r.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your text"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Font"}),(0,r.jsx)("select",{value:l,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:I.map(e=>(0,r.jsx)("option",{value:e,style:{fontFamily:e},children:e},e))})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),(0,r.jsx)("select",{value:c,onChange:e=>o(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:E.map(e=>(0,r.jsxs)("option",{value:e,children:[e,"px"]},e))})]}),(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(!g),className:"px-3 py-2 border rounded-lg font-bold ".concat(g?"bg-gray-200 border-gray-400":"border-gray-300"),children:"B"}),(0,r.jsx)("button",{onClick:()=>v(!p),className:"px-3 py-2 border rounded-lg italic ".concat(p?"bg-gray-200 border-gray-400":"border-gray-300"),children:"I"})]})]}),(0,r.jsx)(M,{color:d,onChange:h,label:"Text Color"}),(0,r.jsx)("button",{onClick:()=>{if(!t||!a.trim())return;let e=new u.aW(a,{left:t.width/2,top:t.height/2,originX:"center",originY:"center",fontFamily:l,fontSize:c,fill:d,fontWeight:g?"bold":"normal",fontStyle:p?"italic":"normal",data:{id:m(),type:"text"}});t.add(e),t.setActiveObject(e),t.renderAll()},className:"w-full py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Add Text"})]})}let _=(0,c.Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var z=a(1619);function F(e){let{canvas:t}=e,a=(0,s.useRef)(null),[n,l]=(0,s.useState)(!1),{addUploadedAsset:i}=h(),c=async e=>{var r;let s=null===(r=e.target.files)||void 0===r?void 0:r[0];if(s&&t){if(!["image/jpeg","image/png","image/webp","image/svg+xml"].includes(s.type)){alert("Please select a JPEG, PNG, WebP, or SVG image");return}if(s.size>5242880){alert("Image must be under 5MB");return}l(!0);try{let{url:e}=await (0,z.cT)(s);i(e);let a=await u.I.fromURL(e,{crossOrigin:"anonymous"});if(a){let r=Math.min(150/(a.width||1),150/(a.height||1));a.set({left:t.width/2,top:t.height/2,originX:"center",originY:"center",scaleX:r,scaleY:r,data:{id:m(),type:"image",url:e}}),t.add(a),t.setActiveObject(a),t.renderAll()}}catch(e){console.error("Upload failed:",e),alert("Failed to upload image. Please try again.")}finally{l(!1),a.current&&(a.current.value="")}}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("input",{ref:a,type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",onChange:c,className:"hidden"}),(0,r.jsxs)("button",{onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.click()},disabled:n,className:"w-full flex items-center justify-center gap-2 py-8 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors disabled:opacity-50",children:[(0,r.jsx)(_,{className:"w-6 h-6 text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-600",children:n?"Uploading...":"Click to upload image"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Supports JPEG, PNG, WebP, SVG up to 5MB"})]})}let P=[{id:"heart",name:"Heart",category:"Love",path:"/icons/heart.svg"},{id:"heart-outline",name:"Heart Outline",category:"Love",path:"/icons/heart-outline.svg"},{id:"star",name:"Star",category:"Stars",path:"/icons/star.svg"},{id:"star-outline",name:"Star Outline",category:"Stars",path:"/icons/star-outline.svg"},{id:"sparkle",name:"Sparkle",category:"Stars",path:"/icons/sparkle.svg"},{id:"arrow-up",name:"Arrow Up",category:"Arrows",path:"/icons/arrow-up.svg"},{id:"arrow-right",name:"Arrow Right",category:"Arrows",path:"/icons/arrow-right.svg"},{id:"arrow-curved",name:"Curved Arrow",category:"Arrows",path:"/icons/arrow-curved.svg"},{id:"speech-bubble",name:"Speech Bubble",category:"Speech",path:"/icons/speech-bubble.svg"},{id:"thought-bubble",name:"Thought Bubble",category:"Speech",path:"/icons/thought-bubble.svg"},{id:"badge-circle",name:"Circle Badge",category:"Badges",path:"/icons/badge-circle.svg"},{id:"badge-ribbon",name:"Ribbon Badge",category:"Badges",path:"/icons/badge-ribbon.svg"},{id:"banner",name:"Banner",category:"Badges",path:"/icons/banner.svg"},{id:"sun",name:"Sun",category:"Nature",path:"/icons/sun.svg"},{id:"moon",name:"Moon",category:"Nature",path:"/icons/moon.svg"},{id:"cloud",name:"Cloud",category:"Nature",path:"/icons/cloud.svg"},{id:"lightning",name:"Lightning",category:"Nature",path:"/icons/lightning.svg"},{id:"flower",name:"Flower",category:"Nature",path:"/icons/flower.svg"},{id:"checkmark",name:"Checkmark",category:"Symbols",path:"/icons/checkmark.svg"},{id:"x-mark",name:"X Mark",category:"Symbols",path:"/icons/x-mark.svg"},{id:"plus",name:"Plus",category:"Symbols",path:"/icons/plus.svg"},{id:"crown",name:"Crown",category:"Symbols",path:"/icons/crown.svg"},{id:"fire",name:"Fire",category:"Symbols",path:"/icons/fire.svg"},{id:"music-note",name:"Music Note",category:"Symbols",path:"/icons/music-note.svg"},{id:"hashtag",name:"Hashtag",category:"Symbols",path:"/icons/hashtag.svg"}],R=Array.from(new Set(P.map(e=>e.category)));function Z(e){let{canvas:t}=e,[a,n]=(0,s.useState)(null),l=a?P.filter(e=>e.category===a):P,i=async e=>{if(t)try{let a=await u.I.fromURL(e,{crossOrigin:"anonymous"});if(a){let e=Math.min(80/(a.width||1),80/(a.height||1));a.set({left:t.width/2,top:t.height/2,originX:"center",originY:"center",scaleX:e,scaleY:e,data:{id:m(),type:"icon"}}),t.add(a),t.setActiveObject(a),t.renderAll()}}catch(e){console.error("Failed to load icon:",e)}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,r.jsx)("button",{onClick:()=>n(null),className:"px-3 py-1 text-sm rounded-full transition-colors ".concat(a?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-600 text-white"),children:"All"}),R.map(e=>(0,r.jsx)("button",{onClick:()=>n(e),className:"px-3 py-1 text-sm rounded-full transition-colors ".concat(a===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))]}),(0,r.jsx)("div",{className:"grid grid-cols-6 gap-2",children:l.map(e=>(0,r.jsx)("button",{onClick:()=>i(e.path),className:"p-2 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",title:e.name,children:(0,r.jsx)("img",{src:e.path,alt:e.name,className:"w-8 h-8 mx-auto"})},e.id))})]})}let B=(0,c.Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),L=(0,c.Z)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),U=(0,c.Z)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),T=(0,c.Z)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),D=(0,c.Z)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var q=a(8930);function H(e){let{canvas:t}=e,{selectedObjectId:a,setSelectedObjectId:n}=h(),[,l]=(0,s.useState)({});if((0,s.useEffect)(()=>{if(!t)return;let e=()=>{l({})};return t.on("object:added",e),t.on("object:removed",e),t.on("object:modified",e),()=>{t.off("object:added",e),t.off("object:removed",e),t.off("object:modified",e)}},[t]),!t)return null;let i=x(t).reverse(),c=e=>e.data,o=e=>{t.setActiveObject(e),t.renderAll();let a=c(e);n((null==a?void 0:a.id)||null)},d=e=>{t.bringObjectForward(e),t.renderAll(),l({})},u=e=>{t.sendObjectBackwards(e),t.renderAll(),l({})},g=e=>{let a=c(e);e.clone().then(r=>{r.data={...a,id:m()},r.set({left:(e.left||0)+20,top:(e.top||0)+20}),t.add(r),t.setActiveObject(r),t.renderAll()})},p=e=>{t.remove(e),t.renderAll(),n(null)},v=e=>{e.set("visible",!e.visible),t.renderAll(),l({})},b=e=>{let t=c(e),a=(null==t?void 0:t.type)||e.type;if("i-text"===e.type||"text"===e.type){let t=e.text||"";return t.length>15?t.substring(0,15)+"...":t}return(null==a?void 0:a.charAt(0).toUpperCase())+(null==a?void 0:a.slice(1))||"Object"};return 0===i.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No objects on canvas yet"}):(0,r.jsx)("div",{className:"space-y-2",children:i.map(e=>{let t=c(e),s=null==t?void 0:t.id,n=s===a;return(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg cursor-pointer transition-colors ".concat(n?"bg-blue-100":"bg-gray-50 hover:bg-gray-100"),onClick:()=>o(e),children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),v(e)},className:"p-1 text-gray-400 hover:text-gray-600",children:!1!==e.visible?(0,r.jsx)(B,{className:"w-4 h-4"}):(0,r.jsx)(L,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"flex-1 text-sm truncate",children:b(e)}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),d(e)},className:"p-1 text-gray-400 hover:text-gray-600",title:"Move up",children:(0,r.jsx)(U,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),u(e)},className:"p-1 text-gray-400 hover:text-gray-600",title:"Move down",children:(0,r.jsx)(T,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),g(e)},className:"p-1 text-gray-400 hover:text-gray-600",title:"Duplicate",children:(0,r.jsx)(D,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),p(e)},className:"p-1 text-gray-400 hover:text-red-500",title:"Delete",children:(0,r.jsx)(q.Z,{className:"w-4 h-4"})})]})]},s||Math.random())})})}let W=(0,c.Z)("flip-horizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]),Y=(0,c.Z)("flip-vertical",[["path",{d:"M21 8V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v3",key:"14bfxa"}],["path",{d:"M21 16v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3",key:"14rx03"}],["path",{d:"M4 12H2",key:"rhcxmi"}],["path",{d:"M10 12H8",key:"s88cx1"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}]]);function X(e){let{canvas:t}=e,{selectedObjectId:a,setSelectedObjectId:n}=h(),[,l]=(0,s.useState)({});(0,s.useEffect)(()=>{let e=()=>{l({})};return t.on("selection:created",e),t.on("selection:updated",e),t.on("selection:cleared",e),()=>{t.off("selection:created",e),t.off("selection:updated",e),t.off("selection:cleared",e)}},[t]);let i=t.getActiveObject(),c=i?i.data:null;if(!i||(null==c?void 0:c.id)!==a)return null;let o="i-text"===i.type||"text"===i.type,d=o?i:null;return(0,r.jsxs)("div",{className:"flex items-center gap-4 p-3 border-b bg-gray-50",children:[o&&(0,r.jsx)(M,{color:(null==d?void 0:d.fill)||"#000000",onChange:e=>{d&&(d.set("fill",e),t.renderAll())}}),(0,r.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,r.jsx)("button",{onClick:()=>{i.set("flipX",!i.flipX),t.renderAll()},className:"p-2 text-gray-600 hover:bg-gray-200 rounded-lg",title:"Flip horizontal",children:(0,r.jsx)(W,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>{i.set("flipY",!i.flipY),t.renderAll()},className:"p-2 text-gray-600 hover:bg-gray-200 rounded-lg",title:"Flip vertical",children:(0,r.jsx)(Y,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>{i.clone().then(e=>{e.data={...c,id:m()},e.set({left:(i.left||0)+20,top:(i.top||0)+20}),t.add(e),t.setActiveObject(e),t.renderAll()})},className:"p-2 text-gray-600 hover:bg-gray-200 rounded-lg",title:"Duplicate",children:(0,r.jsx)(D,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>{t.remove(i),t.renderAll(),n(null)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",title:"Delete",children:(0,r.jsx)(q.Z,{className:"w-5 h-5"})})]})]})}function V(e){let{canvas:t,variant:a,onSave:n,isSaving:l}=e,[i,c]=(0,s.useState)(!1),[o,d]=(0,s.useState)("text"),{selectedObjectId:u}=h(),g=[{id:"text",icon:j,label:"Text"},{id:"image",icon:w,label:"Image"},{id:"icons",icon:N,label:"Icons"},{id:"layers",icon:k,label:"Layers"}];return(0,r.jsxs)("div",{className:"flex border-l bg-white transition-all duration-300 ".concat(i?"w-12":"w-80"),children:[(0,r.jsx)("button",{onClick:()=>c(!i),className:"flex items-center justify-center w-6 border-r bg-gray-50 hover:bg-gray-100 transition-colors",title:i?"Expand panel":"Collapse panel",children:i?(0,r.jsx)(S,{className:"w-4 h-4 text-gray-500"}):(0,r.jsx)(C,{className:"w-4 h-4 text-gray-500"})}),i?(0,r.jsx)("div",{className:"flex flex-col items-center py-2 gap-1",children:g.map(e=>{let t=e.icon;return(0,r.jsx)("button",{onClick:()=>{d(e.id),c(!1)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:e.label,children:(0,r.jsx)(t,{className:"w-5 h-5"})},e.id)})}):(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"flex border-b bg-gray-50 shrink-0",children:g.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>d(e.id),className:"flex-1 flex flex-col items-center gap-1 py-3 transition-colors ".concat(o===e.id?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-100"),children:[(0,r.jsx)(t,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.id)})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:["text"===o&&(0,r.jsx)(O,{canvas:t}),"image"===o&&(0,r.jsx)(F,{canvas:t}),"icons"===o&&(0,r.jsx)(Z,{canvas:t}),"layers"===o&&(0,r.jsx)(H,{canvas:t})]}),u&&t&&(0,r.jsx)("div",{className:"border-t",children:(0,r.jsx)(X,{canvas:t})}),(0,r.jsxs)("div",{className:"border-t p-4 bg-gray-50 shrink-0",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold text-gray-900 mb-3",children:["$",(a.price_cents/100).toFixed(2)]}),(0,r.jsx)("button",{onClick:n,disabled:l,className:"w-full py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:l?"Saving...":"Save & Add to Cart"})]})]})]})}let G=(0,c.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function J(e){let{isOpen:t,onClose:a,children:n,title:l}=e,i=(0,s.useRef)(null),[c,o]=(0,s.useState)(0),[d,u]=(0,s.useState)(!1),h=(0,s.useRef)(0);return((0,s.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),t)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30 z-40 transition-opacity",onClick:a}),(0,r.jsxs)("div",{ref:i,className:(0,f.W)("fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl shadow-xl","transition-transform duration-200 ease-out",!d&&"transition-transform"),style:{transform:"translateY(".concat(c,"px)"),maxHeight:"80vh",paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:[(0,r.jsx)("div",{className:"flex justify-center py-3 cursor-grab active:cursor-grabbing touch-none",onTouchStart:e=>{h.current=e.touches[0].clientY,u(!0)},onTouchMove:e=>{if(!d)return;let t=e.touches[0].clientY-h.current;t>0&&o(t)},onTouchEnd:()=>{u(!1),c>100&&a(),o(0)},children:(0,r.jsx)("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),l&&(0,r.jsx)("div",{className:"px-4 pb-2 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-center",children:l})}),(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:"calc(80vh - 60px)"},children:n})]})]}):null}function K(e){let{canvas:t,onSave:a,isSaving:n,onUndo:l,onRedo:i,canUndo:c,canRedo:u}=e,[g,m]=(0,s.useState)(null),{selectedObjectId:x}=h(),p=e=>{m(g===e?null:e)};return(0,r.jsxs)(r.Fragment,{children:[x&&t&&(0,r.jsx)("div",{className:"fixed bottom-16 left-0 right-0 bg-white border-t z-20 safe-area-bottom",children:(0,r.jsx)(X,{canvas:t})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-30 safe-area-bottom",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 py-2",children:[(0,r.jsx)("div",{className:"flex gap-1",children:[{id:"text",icon:j,label:"Text"},{id:"image",icon:w,label:"Image"},{id:"icons",icon:N,label:"Icons"},{id:"layers",icon:k,label:"Layers"}].map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>p(e.id),className:(0,f.W)("flex flex-col items-center gap-0.5 px-3 py-2 rounded-lg transition-colors min-w-[56px] min-h-[44px]",g===e.id?"bg-blue-100 text-blue-700":"text-gray-600 active:bg-gray-100"),children:[(0,r.jsx)(t,{className:"w-6 h-6"}),(0,r.jsx)("span",{className:"text-[10px] font-medium",children:e.label})]},e.id)})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:l,disabled:!c,className:"p-2.5 text-gray-600 active:bg-gray-100 rounded-lg disabled:opacity-30 min-h-[44px] min-w-[44px] flex items-center justify-center",children:(0,r.jsx)(o,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:i,disabled:!u,className:"p-2.5 text-gray-600 active:bg-gray-100 rounded-lg disabled:opacity-30 min-h-[44px] min-w-[44px] flex items-center justify-center",children:(0,r.jsx)(d,{className:"w-5 h-5"})}),(0,r.jsxs)("button",{onClick:a,disabled:n,className:(0,f.W)("flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium transition-colors min-h-[44px]","bg-blue-600 text-white active:bg-blue-700","disabled:bg-gray-300 disabled:cursor-not-allowed"),children:[(0,r.jsx)(G,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:n?"Saving...":"Done"})]})]})]})}),(0,r.jsx)(J,{isOpen:null!==g,onClose:()=>m(null),title:(()=>{switch(g){case"text":return"Add Text";case"image":return"Upload Image";case"icons":return"Icons";case"layers":return"Layers";default:return""}})(),children:(0,r.jsxs)("div",{className:"p-4 pb-8",children:["text"===g&&(0,r.jsx)(O,{canvas:t}),"image"===g&&(0,r.jsx)(F,{canvas:t}),"icons"===g&&(0,r.jsx)(Z,{canvas:t}),"layers"===g&&(0,r.jsx)(H,{canvas:t})]})})]})}var $=a(6904);function Q(e){let{product:t,variant:a}=e,l=(0,n.useRouter)(),c=(0,s.useRef)(null),[u,m]=(0,s.useState)(!1),[x,f]=(0,s.useState)(null),j=g(),w=(0,s.useCallback)(e=>{f(e)},[]),{initialize:N,canUndo:k,canRedo:S,undo:C,redo:A,getDesignData:M,currentViewId:I,canvasStates:E,reset:O}=h(),{addItem:_,openCart:F}=(0,$.x)();(0,s.useEffect)(()=>(t.mockup_config&&N(t.id,a.sku,t.mockup_config),()=>{O()}),[t.id,a.sku,t.mockup_config]);let P=async()=>{let e=C();if(e){var t;let a=null===(t=c.current)||void 0===t?void 0:t.getCanvas();a&&await v(a,e.state)}},R=async()=>{let e=A();if(e){var t;let a=null===(t=c.current)||void 0===t?void 0:t.getCanvas();a&&await v(a,e.state)}},Z=async()=>{var e;let r=null===(e=c.current)||void 0===e?void 0:e.getCanvas();if(r){m(!0);try{let e=p(r);h.getState().saveCanvasState(I,e);let s=r.toDataURL({format:"png",quality:.8,multiplier:2}),n=await fetch(s),i=await n.blob(),c=new File([i],"preview.png",{type:"image/png"}),{url:o}=await (0,z.cT)(c),{canvasStates:d,assets:u}=M();_({sku:a.sku,title:"".concat(t.title," - ").concat(a.title),price_cents:a.price_cents,qty:1,image_url:a.image_url||void 0,design_preview_url:o,design_data:JSON.stringify(d),design_assets:u}),F(),l.push("/cart")}catch(e){console.error("Failed to save design:",e),alert("Failed to save design. Please try again.")}finally{m(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col h-full no-overscroll",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border-b bg-white",children:[(0,r.jsx)("button",{onClick:()=>{Object.values(E).some(e=>{try{let t=JSON.parse(e);return t.objects&&t.objects.length>0}catch(e){return!1}})?confirm("Are you sure? Your design will be lost.")&&(O(),l.back()):(O(),l.back())},className:"p-2 -ml-2 text-gray-600 hover:text-gray-900 active:bg-gray-100 rounded-lg min-h-[44px] min-w-[44px] flex items-center justify-center",children:(0,r.jsx)(i.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("h1",{className:"text-lg font-semibold truncate px-4",children:["Customize: ",t.title]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:P,disabled:!k(),className:"p-2 text-gray-600 hover:text-gray-900 active:bg-gray-100 rounded-lg disabled:opacity-30 min-h-[44px] min-w-[44px] flex items-center justify-center",title:"Undo",children:(0,r.jsx)(o,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:R,disabled:!S(),className:"p-2 text-gray-600 hover:text-gray-900 active:bg-gray-100 rounded-lg disabled:opacity-30 min-h-[44px] min-w-[44px] flex items-center justify-center",title:"Redo",children:(0,r.jsx)(d,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,r.jsx)("div",{className:"flex justify-center py-3 border-b bg-gray-50",children:(0,r.jsx)(y,{})}),(0,r.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100",style:{paddingBottom:j?"80px":"0"},children:(0,r.jsx)("div",{className:"p-4 flex items-center justify-center min-h-full",children:(0,r.jsx)(b,{ref:c,onCanvasReady:w})})})]}),!j&&(0,r.jsx)(V,{canvas:x,variant:a,onSave:Z,isSaving:u})]}),j&&(0,r.jsx)(K,{canvas:x,onSave:Z,isSaving:u,onUndo:P,onRedo:R,canUndo:k(),canRedo:S()})]})}function ee(){return(0,r.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50 animate-pulse",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"w-32 h-5 bg-gray-200 rounded"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"})]})]})}),(0,r.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("div",{className:"w-20 h-8 bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"w-20 h-8 bg-gray-200 rounded-lg"})]})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col lg:flex-row",children:[(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md aspect-[5/6] bg-gray-200 rounded-lg"})}),(0,r.jsxs)("div",{className:"lg:w-80 bg-white border-t lg:border-t-0 lg:border-l border-gray-200 p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[(0,r.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"w-full h-10 bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"w-full h-10 bg-gray-200 rounded-lg"}),(0,r.jsx)("div",{className:"w-3/4 h-10 bg-gray-200 rounded-lg"})]})]})]}),(0,r.jsx)("div",{className:"bg-white border-t border-gray-200 px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,r.jsx)("div",{className:"w-24 h-6 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"w-32 h-10 bg-gray-200 rounded-lg"})]})})]})}class et extends s.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught:",e,t)}render(){if(this.state.hasError){var e;return this.props.fallback?this.props.fallback:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"An unexpected error occurred"}),(0,r.jsx)("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}function ea(){let e=(0,n.useSearchParams)(),t=e.get("id"),a=e.get("sku"),{data:s,isLoading:i,error:c}=(0,l.i)(t||"");if(!t)return(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No product specified"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Please select a product to customize."}),(0,r.jsx)("a",{href:"/",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to shop"})]})});if(i)return(0,r.jsx)(ee,{});if(c||!s)return(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Product not found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"The product you're looking for doesn't exist or has been removed."}),(0,r.jsx)("a",{href:"/",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to shop"})]})});if(!s.customizable||!s.mockup_config)return(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83C\uDFA8"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Not customizable"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"This product doesn't support customization."}),(0,r.jsx)("a",{href:"/",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to shop"})]})});let o=s.variants.find(e=>e.sku===a)||s.variants[0];return o?(0,r.jsx)("div",{className:"h-screen flex flex-col",children:(0,r.jsx)(Q,{product:s,variant:o})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Variant not found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"The selected variant is not available."}),(0,r.jsx)("a",{href:"/",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Return to shop"})]})})}function er(){return(0,r.jsx)(et,{children:(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)(ee,{}),children:(0,r.jsx)(ea,{})})})}},6229:function(e,t,a){"use strict";a.d(t,{i:function(){return l},r:function(){return n}});var r=a(1713),s=a(1619);function n(){return(0,r.a)({queryKey:["products"],queryFn:async()=>{let e=await (0,s.hi)("/v1/products?status=active");return{products:e.items,pagination:e.pagination}}})}function l(e){return(0,r.a)({queryKey:["product",e],queryFn:()=>(0,s.hi)("/v1/products/".concat(e)),enabled:!!e})}},1619:function(e,t,a){"use strict";a.d(t,{hi:function(){return n},cT:function(){return l}});let r={apiUrl:"https://merchant.riki-dd7.workers.dev",apiKey:"pk_6cac8a6e66ed66449be88e9eda5140a68129720dac26e97d"};class s extends Error{constructor(e,t,a){super(a),this.status=e,this.code=t,this.name="ApiError"}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:a="GET",body:n,headers:l={}}=t,i="".concat(r.apiUrl).concat(e),c=await fetch(i,{method:a,headers:{"Content-Type":"application/json",...r.apiKey&&{Authorization:"Bearer ".concat(r.apiKey)},...l},body:n?JSON.stringify(n):void 0}),o=await c.json();if(!c.ok){var d,u;throw new s(c.status,(null===(d=o.error)||void 0===d?void 0:d.code)||"unknown",(null===(u=o.error)||void 0===u?void 0:u.message)||"An error occurred")}return o}async function l(e){let t=new FormData;t.append("file",e);let a=await fetch("".concat(r.apiUrl,"/v1/designs/upload"),{method:"POST",headers:{...r.apiKey&&{Authorization:"Bearer ".concat(r.apiKey)}},body:t}),n=await a.json();if(!a.ok){var l,i;throw new s(a.status,(null===(l=n.error)||void 0===l?void 0:l.code)||"upload_failed",(null===(i=n.error)||void 0===i?void 0:i.message)||"Upload failed")}return n}},6904:function(e,t,a){"use strict";a.d(t,{x:function(){return n}});var r=a(9625),s=a(6885);let n=(0,r.Ue)()((0,s.tJ)((e,t)=>({items:[],isOpen:!1,editingItemId:null,addItem:t=>{let a=!!(t.design_data||t.design_preview_url);e(e=>{if(a){let a={...t,id:crypto.randomUUID()};return{items:[...e.items,a]}}let r=e.items.findIndex(e=>e.sku===t.sku&&!e.design_data&&!e.design_preview_url);if(r>=0){let a=[...e.items];return a[r]={...a[r],qty:a[r].qty+t.qty},{items:a}}let s={...t,id:t.sku};return{items:[...e.items,s]}})},removeItem:t=>{e(e=>({items:e.items.filter(e=>e.id!==t)}))},updateQuantity:(a,r)=>{if(r<=0){t().removeItem(a);return}e(e=>({items:e.items.map(e=>e.id===a?{...e,qty:r}:e)}))},clearCart:()=>{e({items:[]})},openCart:()=>{e({isOpen:!0})},closeCart:()=>{e({isOpen:!1})},toggleCart:()=>{e(e=>({isOpen:!e.isOpen}))},setEditingItem:t=>{e({editingItemId:t})},updateItemDesign:(t,a,r,s)=>{e(e=>({items:e.items.map(e=>e.id===t?{...e,design_data:a,design_preview_url:null!=r?r:e.design_preview_url,design_assets:null!=s?s:e.design_assets}:e),editingItemId:null}))},itemCount:()=>t().items.reduce((e,t)=>e+t.qty,0),subtotalCents:()=>t().items.reduce((e,t)=>e+t.price_cents*t.qty,0)}),{name:"cart-storage",partialize:e=>({items:e.items})}))}},function(e){e.O(0,[788,883,661,713,971,117,744],function(){return e(e.s=242)}),_N_E=e.O()}]);